{"version":3,"sources":["base.js","circles.js","index.js"],"names":["$svg","d3","select","padding","top","bottom","left","right","startDate","endDate","domMult","intMult","yearLine","domLine","intLine","setupBase","baseGroup","yearGroup","append","attr","i","text","resizeBase","el","height","width","circles","selectAll","radius","$hoverBox","$mainBoxes","setupCircles","nodes","forEach","data","dataset","id","createId","on","highlight","influence","hover","clearHighlight","clickHandler","resizeCircles","xMult","type","xPos","yPos","getYFrac","date","slice","replace","frac","comps","split","Number","inf","self","trim","influences","transition","pos","node","getBoundingClientRect","classed","style","x","y","html","main","console","log","init","resize","window","innerWidth","innerHeight","addEventListener"],"mappings":"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","file":"index.js","sourceRoot":"../src/js","sourcesContent":["import { width, height } from \"./index\";\n\nconst $svg = d3.select(\"#graphic-container\");\nconst padding = { top: 10, bottom: 10, left: 50, right: 10 },\n  startDate = 1980,\n  endDate = 2020;\nconst domMult = 0.15,\n  intMult = 0.85;\nlet yearLine, domLine, intLine;\n\nfunction setupBase() {\n  const baseGroup = $svg.select(\"#base-group\");\n  const yearGroup = baseGroup.append(\"g\").attr(\"id\", \"year-group\");\n  for (let i = startDate; i <= endDate; i++) {\n    if (i % 10 == 0) {\n      yearGroup\n        .append(\"text\")\n        .text(i)\n        .attr(\"id\", `year-marker-${i}`)\n        .attr(\"class\", \"year-marker-text\")\n        .attr(\"alignment-baseline\", \"middle\")\n        .attr(\"text-anchor\", \"middle\");\n    } else {\n      yearGroup\n        .append(\"line\")\n        .attr(\"id\", `year-marker-${i}`)\n        .attr(\"class\", \"year-marker-dash\");\n    }\n  }\n  domLine = baseGroup.append(\"line\").attr(\"id\", \"domLine\");\n  intLine = baseGroup.append(\"line\").attr(\"id\", \"intLine\");\n}\n\nfunction resizeBase() {\n  for (let i = startDate; i <= endDate; i++) {\n    const el = d3.select(`#year-marker-${i}`);\n    if (i % 10 == 0) {\n      el.attr(\"x\", padding.left).attr(\n        \"y\",\n        padding.top + (height * (i - startDate)) / (endDate - startDate)\n      );\n    } else {\n      el.attr(\"x1\", i % 5 == 0 ? padding.left - 10 : padding.left - 5)\n        .attr(\"x2\", i % 5 == 0 ? padding.left + 10 : padding.left + 5)\n        .attr(\n          \"y1\",\n          padding.top + (height * (i - startDate)) / (endDate - startDate)\n        )\n        .attr(\n          \"y2\",\n          padding.top + (height * (i - startDate)) / (endDate - startDate)\n        );\n    }\n  }\n  domLine\n    .attr(\"x1\", padding.left + domMult * width)\n    .attr(\"x2\", padding.left + domMult * width)\n    .attr(\"y1\", padding.top)\n    .attr(\"y2\", padding.top + height);\n\n  intLine\n    .attr(\"x1\", padding.left + intMult * width)\n    .attr(\"x2\", padding.left + intMult * width)\n    .attr(\"y1\", padding.top)\n    .attr(\"y2\", padding.top + height);\n}\n\nexport { setupBase, resizeBase, domMult, intMult, startDate, endDate, padding };\n","import { width, height } from \"./index\";\nimport { domMult, intMult, startDate, endDate, padding } from \"./base\";\n\nconst $svg = d3.select(\"#graphic-container\");\nconst circles = $svg.selectAll(\"circle\");\nconst radius = 10;\n\nconst $hoverBox = d3.select(\"#graphic-hover\");\nconst $mainBoxes = d3.selectAll(\".main-text\");\n\nfunction setupCircles() {\n  circles.nodes().forEach((el, i) => {\n    const data = el.dataset;\n    const id = createId(data);\n    d3.select(el)\n      .attr(\"id\", id)\n      .on(\"mouseenter\", () => highlight(data.influence, id, data.hover))\n      .on(\"mouseleave\", clearHighlight)\n      .on(\"click\", () => clickHandler(data.influence, id));\n  });\n}\n\nfunction resizeCircles() {\n  circles.nodes().forEach((el, i) => {\n    const data = el.dataset;\n    const xMult = data.type === \"international\" ? intMult : domMult;\n    const xPos = padding.left + width * xMult;\n    const yPos = padding.top + height * getYFrac(data.date);\n    d3.select(el).attr(\"r\", radius).attr(\"cx\", xPos).attr(\"cy\", yPos);\n  });\n}\n\nfunction createId(data) {\n  const date = data.date;\n  const type = data.type;\n  return type.slice(0, 1) + date.replace(/\\//gi, \"\");\n}\n\nfunction getYFrac(date) {\n  let frac = 0;\n  const comps = date.split(\"/\");\n  frac +=\n    (Number(comps[2]) +\n      Number(comps[1]) / 12 +\n      Number(comps[0]) / 365 -\n      startDate) /\n    (endDate - startDate);\n  return frac;\n}\n\nfunction highlight(inf, self, hover) {\n  if (inf.trim() != \"\") {\n    const influences = inf.split(\",\");\n    influences.forEach((id) =>\n      d3\n        .select(`#${id.trim()}`)\n        .transition()\n        .attr(\"r\", radius * 1.4)\n        .attr(\"fill\", \"orange\")\n    );\n  }\n\n  d3.select(`#${self}`)\n    .transition()\n    .attr(\"r\", radius * 1.4)\n    .attr(\"fill\", \"yellow\");\n\n  const pos = d3.select(`#${self}`).node().getBoundingClientRect();\n\n  $hoverBox\n    .classed(\"visible\", true)\n    .classed(\"right\", self.slice(0, 1) === \"d\")\n    .style(\"left\", `${pos.x + pos.width / 2}px`)\n    .style(\"top\", `${pos.y + pos.height / 2}px`)\n    .html(hover);\n}\n\nfunction clearHighlight() {\n  circles.nodes().forEach((el, i) => {\n    d3.select(el).transition().attr(\"r\", radius).attr(\"fill\", \"black\");\n  });\n\n  $hoverBox.classed(\"visible\", false);\n}\n\nfunction clickHandler(inf, self) {\n  $mainBoxes.classed(\"visible\", false);\n\n  const influences = inf.split(\",\");\n  [...influences, self].forEach((id, i) => {\n    const data = d3.select(`#${id.trim()}`).node().dataset;\n    d3.select(`#graphic-main-${i}`).classed(\"visible\", true).html(data.main);\n    console.log([id, i]);\n  });\n}\n\nexport { setupCircles, resizeCircles };\n","import { setupBase, resizeBase, padding } from \"./base\";\nimport { setupCircles, resizeCircles } from \"./circles\";\n\nconst $svg = d3.select(\"#graphic-container\");\nlet width, height;\n\nfunction init() {\n  setupBase();\n  setupCircles();\n}\n\nfunction resize() {\n  width = window.innerWidth - padding.left - padding.right;\n  height = window.innerHeight - padding.top - padding.bottom;\n  $svg.attr(\"viewBox\", `0 0 ${window.innerWidth} ${window.innerHeight}`);\n  resizeBase();\n  resizeCircles();\n}\n\ninit();\nresize();\n\nwindow.addEventListener(\"resize\", resize);\n\nexport { width, height };\n"]}